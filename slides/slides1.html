<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="author" content="Ondra Chaloupka / ochaloup@redhat.com"><title>Transactions in Java</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js/css/reveal.min.css" rel="stylesheet"><link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme"><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet"><script type="text/javascript">document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script></head><body><div class="reveal"><div class="slides"><section><h2>Transactions in Java</h2><p><small>Ondra Chaloupka / ochaloup@redhat.com</small></p></section><section id="_transactions_in_java"><h2>Transactions in Java ?</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">@Stateless
public class TestBean {

    @TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
    public void doWork() {
        // do something
    }
}</code></pre></div></div></section>
<section id="_transactions_in_java_2"><h2>Transactions in Java !?</h2><div class="paragraph"><p><span class="image"><img src="./misc/tagcloud.png" alt="tagcloud"></span></p></div></section>
<section id="_agenda"><h2>Agenda</h2><div class="ulist"><ul><li><p>Terminology</p></li><li><p>Resource local transaction in Java SE</p><div class="ulist"><ul><li><p>Database</p></li><li><p>JMS</p></li></ul></div></li><li><p>Global transaction in Java SE</p><div class="ulist"><ul><li><p>Java Transaction API (JTA)</p></li><li><p>Narayana implementation</p></li></ul></div></li><li><p>Transactions in Java EE</p><div class="ulist"><ul><li><p>Bean managed transactions (BMT)</p></li><li><p>Container managed transactions (CMT)</p></li></ul></div></li></ul></div></section>
<section id="_a_transaction"><h2>A transaction</h2><div class="paragraph"><p>A transaction is a group of business logic statements with certain shared properties.</p></div>
<div class="paragraph"><p>One or more of:</p></div>
<div class="paragraph"><p>Atomic, Consistent, Isolated, Durable</p></div>
<aside class="notes"><div class="paragraph"><p>The statement above stolen from presentation of Michael Musgrove for Brno JBug, January 2015
From user point of view a transaction is an atomic unit of the work where everything or nothing is finished.</p></div></aside></section>
<section><section id="_terminology_corner"><h2>Terminology corner</h2><div class="ulist"><ul><li><p>ACID and "his brothers" BASE, BA&#8230;&#8203;</p></li><li><p>Transaction management</p><div class="ulist"><ul><li><p>Resource local</p></li><li><p>Global transaction</p></li><li><p>Distributed transaction</p></li></ul></div></li><li><p>JTA vs. JTS</p></li></ul></div><aside class="notes"><div class="paragraph"><p>BASE
 * connected with the movement of NoSQL
 * tighly coupled with CAP theorem - system could satisfy just two of these three requirements: Consistency, Availability, Parition Tolerance
 * one of the way how to handle CAP "trouble" is relaxing consistency which is where BASE goes
 <strong> Basic Availability -  spread data across many storage systems with a high degree of replication
 </strong> Soft State. - data consistency is the developer&#8217;s problem and should not be handled by the database, consistency is not a goal here
 ** Eventual Consistency - system will eventually become consistent once it stops receiving input
 * some of the NoSQL databases tries to be ACID(like) &#8594; NewSQL - FoundationDB, NuoDB, OrientDB (see wiki :)
BA - business activities
 * BA is term from "another" world - in general it&#8217;s long terming transaction (booking a flight + taxi from the airport)
Txn management
* Resource local - transaction at level of database or JMS server
* Global - transaction "consisting" from several resource local transactions managed by transaction manager
* Distributed transaction - transaction spread over multiple transaction managers
JTA and JTS
The JTA is the interface developers use to manage transactions.
The Java Transaction Service (JTS) is the Java language mapping of the CORBA OTS 1.1 Specification (Object Transaction Service) - defines how to propagate transactions between multiple JTS transaction managers.
The Java Transaction Service (JTS), on the other hand, is an underlying transaction service that implements JTA.
 Think of the relationship between JTA and JTS as similar to the relationship between JDBC and the corresponding underlying database driver; JTA is to JDBC as JTS is to the database driver.</p></div></aside></section><section id="_acid"><h2>ACID</h2><div class="ulist"><ul><li><p>Atomicity</p></li><li><p>Consistency</p></li><li><p>Isolation</p></li><li><p>Durablitity</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p><a href="http://en.wikipedia.org/wiki/ACID" class="bare">http://en.wikipedia.org/wiki/ACID</a>
Atomicity
 * all or nothing
 * one part of transaction fails then whole transaction fails
Consistency
 * transaction will bring the database from one valid state to another according to defined rules (as constraints, cascades, triggers&#8230;&#8203;)
 * does not mean correctness of transaction from business point of view
Isolation
 * for transaction itself the system behaves like the paralel transactions would be run in serial order
 * concurrent execution of transactions results in a system state that would be obtained if transactions were executed serially (one by one)
Durablitity
 * once a transaction has been committed, it will remain so, even in the event of power loss, crashes, or errors</p></div></aside></section></section>
<section id="_references"><h2>References</h2><div class="ulist"><ul><li><p>Java Transaction Design Strategies (<a href="http://www.infoq.com/minibooks/JTDS" class="bare">http://www.infoq.com/minibooks/JTDS</a>)</p></li><li><p>My bookmarks on <a href="https://delicious.com/chalda/ts.presentation" class="bare">https://delicious.com/chalda/ts.presentation</a></p></li></ul></div>
<div class="openblock"><div class="content"></div></div></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.min.js"></script><script type="text/javascript">// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: false,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: false,
  // Push each slide change to the browser history
  history: false,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: false,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, blond, default, moon, night, serif, simple, sky, solarized)
  theme: Reveal.getQueryHash().theme || 'redhat',
  // Transition style (e.g., default, cube, page, concave, zoom, linear, fade, none)
  transition: Reveal.getQueryHash().transition || 'default',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., default, none, slide, concave, convex, zoom)
  backgroundTransition: 'default',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script></body></html>